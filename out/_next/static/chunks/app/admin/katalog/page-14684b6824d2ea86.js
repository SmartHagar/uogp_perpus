(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3393],{9806:function(t,l,r){Promise.resolve().then(r.bind(r,2163))},2163:function(t,l,r){"use strict";r.r(l),r.d(l,{default:function(){return page}});var s=r(7437),n=r(2265),i=r(3423),o=r(7310),d=r(4660),u=r(4810),c=r(8875),h=r(5967);let g=(0,d.Ue)((0,u.mW)((t,l)=>({setFormData:t=>{let l=new FormData;return l.append("judul",t.judul),l.append("class_sub_id",t.class_sub_id),l.append("penulis",t.penulis),l.append("penerbit",t.penerbit),l.append("jenis",t.jenis),l.append("tahun",t.tahun),l.append("stok",t.stok),l.append("cover",t.cover),l},dtKatalog:[],showKatalog:[],setKatalog:async l=>{let{page:r=1,limit:s=10,search:n,jenis:i}=l;try{let l=await h.Z.getState().setToken(),o=await (0,c.Sj)({method:"get",url:"/katalog",headers:{Authorization:"Bearer ".concat(l)},params:{limit:s,page:r,search:n,jenis:i}});return t(t=>({...t,dtKatalog:o.data.data})),{status:"berhasil",data:o.data}}catch(t){var o;return{status:"error",error:null===(o=t.response)||void 0===o?void 0:o.data}}},setShowKatalog:async l=>{try{let r=await h.Z.getState().setToken(),s=await (0,c.Sj)({method:"get",url:"/katalog/".concat(l),headers:{Authorization:"Bearer ".concat(r)}});return console.log({response:s}),t(t=>({...t,showKatalog:s.data.data})),{status:"berhasil",data:s.data}}catch(t){var r;return{status:"error",error:null===(r=t.response)||void 0===r?void 0:r.data}}},addData:async r=>{let s=(null==r?void 0:r.cover)?l().setFormData(r):r;try{let l=await h.Z.getState().setToken(),r=await (0,c.Sj)({method:"post",url:"/katalog",headers:{Authorization:"Bearer ".concat(l),"Content-Type":"multipart/form-data"},data:s});return t(t=>({dtKatalog:{last_page:t.dtKatalog.last_page,current_page:t.dtKatalog.current_page,data:[r.data.data,...t.dtKatalog.data]}})),{status:"berhasil tambah",data:r.data}}catch(t){return{status:"error",data:t.response.data}}},removeData:async l=>{try{let r=await h.Z.getState().setToken(),s=await (0,c.Sj)({method:"delete",url:"/katalog/".concat(l),headers:{Authorization:"Bearer ".concat(r)}});return t(t=>({dtKatalog:{last_page:t.dtKatalog.last_page,current_page:t.dtKatalog.current_page,data:t.dtKatalog.data.filter(t=>t.id!==l)}})),{status:"berhasil hapus",data:s.data}}catch(t){return{status:"error",data:t.response.data}}},updateData:async(r,s)=>{delete s.id;let n=(null==s?void 0:s.cover)?l().setFormData(s):s,i=await h.Z.getState().setToken();try{let l=await (0,c.Sj)({url:"/katalog/".concat(r),method:"post",headers:(null==s?void 0:s.cover)?{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(i)}:{Authorization:"Bearer ".concat(i)},data:n,params:{_method:"PUT"}});return t(t=>({dtKatalog:{last_page:t.dtKatalog.last_page,current_page:t.dtKatalog.current_page,data:t.dtKatalog.data.map(t=>t.id===r?{...t,...l.data.data}:t)}})),{status:"berhasil update",data:l.data}}catch(t){return{status:"error",data:t.response.data}}}})));var m=r(5991),p=r(4033),katalog_ShowData=t=>{let{setDelete:l,setEdit:r,search:d}=t,{setKatalog:u,dtKatalog:c}=g(),[h,f]=(0,n.useState)(1),[b,v]=(0,n.useState)(10),[j,y]=(0,n.useState)(!0),x=(0,p.useSearchParams)(),w=x&&x.get("jenis")||"",fetchDataKatalog=async()=>{await u({page:h,limit:b,search:d,jenis:w}),y(!1)};return(0,n.useEffect)(()=>(fetchDataKatalog(),()=>{}),[h,b]),(0,n.useEffect)(()=>{f(1),fetchDataKatalog()},[w]),(0,n.useEffect)(()=>{f(1),fetchDataKatalog()},[d]),(0,s.jsx)("div",{className:"flex-1 flex-col max-w-full h-full overflow-auto",children:j?(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)(m.Z,{})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"",children:(0,s.jsx)(o.Z,{headTable:["No","Class Sub","Judul","Penulis","Penerbit","Tahun","Stok","Cover","Aksi"],tableBodies:["class_sub.nm_sub","judul","penulis","penerbit","tahun","stok","cover"],dataTable:c.data,page:h,limit:b,setEdit:r,setDelete:l,ubah:!0,hapus:!0})}),(null==c?void 0:c.last_page)>1&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(i.Z,{currentPage:null==c?void 0:c.current_page,totalPages:null==c?void 0:c.last_page,setPage:f})})]})})},f=r(5782),b=r(8963),v=r(311),j=r(1865),y=r(592),x=r(945),w=r(675);let S=(0,d.Ue)((0,u.mW)((t,l)=>({dtClassSub:[],setClassSub:async l=>{let{page:r=1,limit:s=10,search:n}=l;try{let l=await (0,c.hi)({method:"get",url:"/classSub",params:{limit:s,page:r,search:n}});return t(t=>({...t,dtClassSub:l.data})),{status:"berhasil",data:l.data}}catch(t){return{status:"error",error:t.response.data}}},setClassSubAll:async l=>{let{search:r}=l;try{let l=await (0,c.hi)({method:"get",url:"/classSub/all",params:{search:r}});return t(t=>({...t,dtClassSub:l.data})),{status:"berhasil",data:l.data}}catch(t){return{status:"error",error:t.response.data}}}})));r(1240);var form_BodyForm=t=>{let{register:l,errors:r,control:i,dtEdit:o,watch:d,setValue:u,showModal:c,myFile:h,setMyFile:g}=t,{setClassSubAll:m,dtClassSub:p}=S(),fetchDataClassSub=async t=>{let{search:l}=t;await m({search:l})};return(0,n.useEffect)(()=>{fetchDataClassSub({})},[c]),(0,s.jsxs)(s.Fragment,{children:[(null==p?void 0:p.data)&&(0,s.jsx)(x.Z,{label:"Class Sub",placeholder:"Pilih Class Sub",name:"class_sub_id",dataDb:null==p?void 0:p.data,body:["id","class_umum.nm_umum","nm_sub"],control:i,required:!0,errors:r.class_sub_id,addClass:"col-span-4 lg:col-span-2"}),(0,s.jsx)(f.Z,{label:"Judul",name:"judul",register:l,minLength:2,required:!0,errors:r.judul,addClass:"col-span-4"}),(0,s.jsx)(f.Z,{label:"Penulis",name:"penulis",register:l,minLength:2,required:!0,errors:r.penulis,addClass:"col-span-4"}),(0,s.jsx)(f.Z,{label:"Penerbit",name:"penerbit",register:l,minLength:2,required:!0,errors:r.penerbit,addClass:"col-span-4"}),(0,s.jsx)(w.Z,{label:"Tahun",name:"tahun",start:new Date().getFullYear()-50,end:new Date().getFullYear(),control:i,addClass:"col-span-4 lg:col-span-2",placeholder:"Pilih",required:!0,errors:r.tahun}),(0,s.jsx)(f.Z,{label:"stok",name:"stok",register:l,minLength:1,required:!0,errors:r.stok,type:"number",addClass:"col-span-4 lg:col-span-2"}),(0,s.jsx)(y.Z,{label:"Cover",name:"cover",register:l,accept:"image/*",required:!0,errors:r.cover,addClass:"col-span-4",setValue:u,fileEdit:null==o?void 0:o.cover,myFile:h,setMyFile:g})]})},_=r(8528),form_Form=t=>{let{showModal:l,setShowModal:r,dtEdit:i}=t,[o,d]=(0,n.useState)(),u=(0,p.useSearchParams)(),c=u&&u.get("jenis")||"",{addData:h,updateData:m}=g(),{register:y,handleSubmit:x,setValue:w,control:S,formState:{errors:k},watch:C}=(0,j.cI)(),resetForm=()=>{w("id",""),w("class_sub_id",""),w("judul",""),w("penulis",""),w("penerbit",""),w("tahun",""),w("stok",1),w("cover",""),d(null)};(0,n.useEffect)(()=>{i?(w("id",i.id),w("class_sub_id",i.class_sub_id),w("judul",i.judul),w("penulis",i.penulis),w("penerbit",i.penerbit),w("tahun",parseInt(i.tahun)),w("stok",i.stok),w("cover",i.cover)):resetForm()},[l,i]);let onSubmit=async t=>{if(console.log({row:t}),t.jenis=c,i){let{data:l}=await m(i.id,t);(0,v.Z)({event:l}),r(!1)}else{let{data:l}=await h(t);console.log({data:l}),(0,v.Z)({event:l}),(null==l?void 0:l.type)!=="success"||resetForm()}};return(0,s.jsx)(b.Z,{title:"Form Katalog",showModal:l,setShowModal:r,children:(0,s.jsxs)("form",{onSubmit:x(onSubmit),children:[(0,s.jsx)(f.Z,{name:"id",register:y,type:"hidden"}),(0,s.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-4",children:(0,s.jsx)(form_BodyForm,{register:y,errors:k,dtEdit:i,control:S,watch:C,setValue:w,showModal:l,myFile:o,setMyFile:d})}),(0,s.jsx)("div",{children:(0,s.jsx)(_.Z,{type:"submit",onClick:x(onSubmit),addClass:"btn-primary",children:"Simpan"})})]})})},k=r(3015),C=r(5925),F=r(8001),page=()=>{let{removeData:t}=g(),[l,r]=(0,n.useState)(!1),[i,o]=(0,n.useState)(!1),[d,u]=(0,n.useState)(),[c,h]=(0,n.useState)(),[m,f]=(0,n.useState)(""),b=(0,p.useSearchParams)(),j=b&&b.get("jenis"),setDelete=async l=>{let{id:r,isDelete:s}=l;if(u(r),s){let{data:l}=await t(d);(0,v.Z)({event:l}),o(!1)}else o(!0)};return(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(C.x7,{}),(0,s.jsx)(form_Form,{dtEdit:c,showModal:l,setShowModal:r}),(0,s.jsx)(k.Z,{showDel:i,setShowDel:o,setDelete:setDelete}),(0,s.jsxs)("div",{className:"mb-4 flex justify-between",children:[(0,s.jsxs)("p",{children:["Silahkan mengolah data katalog ",(0,s.jsx)("span",{children:j})]}),(0,s.jsx)("div",{children:(0,s.jsx)(_.Z,{onClick:()=>{r(!0),h(null)},addClass:"btn-primary",children:"Tambah"})})]}),(0,s.jsx)(F.Z,{placeholder:"Cari Katalog",onChange:t=>f(t)})]}),(0,s.jsx)(katalog_ShowData,{setDelete:setDelete,setEdit:t=>{r(!0),h(t)},search:m})]})}},592:function(t,l,r){"use strict";var s=r(7437),n=r(8875),i=r(6691),o=r.n(i),d=r(2265),u=r(6678),c=r.n(u);l.Z=t=>{let{label:l,register:r,required:i,name:u,errors:h,addClass:g,accept:m,setValue:p,fileEdit:f,myFile:b,setMyFile:v}=t,[j,y]=(0,d.useState)(),resizeFile=t=>new Promise(()=>{if(t){var l;let r=(null==t?void 0:null===(l=t.type)||void 0===l?void 0:l.split("/"))||[],s=r[0];if("image"!==s)return onSelectFile(t);console.log({splitType:r}),c().imageFileResizer(t,1500,1500,r[1],80,0,t=>{onSelectFile(t)},"file")}else onSelectFile(null)}),onSelectFile=t=>{var l;if(t){let l=new FileReader;l.readAsDataURL(t),l.onloadend=()=>{v(l.result)}}let r=(null==t?void 0:null===(l=t.type)||void 0===l?void 0:l.split("/"))||[];y(r[0]),p(u,t)};return(0,s.jsxs)("div",{className:g,children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:l}),i&&(0,s.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,s.jsx)("input",{className:"w-full text-base px-4 py-2 border  border-gray-300 rounded-lg focus:outline-none focus:border-secondary",id:"fileInput",type:"file",accept:m,onChange:t=>{var l;let r=(null===(l=t.target)||void 0===l?void 0:l.files[0])||null;resizeFile(r)}}),(0,s.jsx)("input",{type:"hidden",id:l,...r(u,{required:i})}),(0,s.jsxs)("div",{className:"flex gap-4 mt-2",children:[b&&"image"===j&&(0,s.jsx)(o(),{className:"rounded-lg",src:b,width:100,height:100,alt:""}),f&&"file"!==u&&(0,s.jsx)("div",{children:(0,s.jsx)(o(),{src:"".concat(n._n,"/").concat(f),width:100,height:100,alt:""})})]}),(null==h?void 0:h.type)==="required"&&(0,s.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[l," tidak boleh kosong"]})]})}},945:function(t,l,r){"use strict";var s=r(7437);r(2265);var n=r(8749),i=r(1865);l.Z=t=>{let{dataDb:l,body:r,control:o,required:d,name:u,errors:c,placeholder:h,addClass:g,label:m,defaultOptions:p=!0,menuPosition:f}=t,b={multiValue:(t,l)=>l.data.isFixed?{...t,backgroundColor:"gray"}:t,multiValueLabel:(t,l)=>l.data.isFixed?{...t,fontWeight:"bold",color:"white",paddingRight:6}:t,multiValueRemove:(t,l)=>l.data.isFixed?{...t,display:"none"}:t},getProperty=(t,l)=>{let r=t[l];if("id"===l)return{value:r,label:""};if(!l.includes("."))return{value:"",label:r};{let[r,...s]=l.split("."),n=t[r];return getProperty(n,s.join("."))}},myOptions=()=>{let t=l&&l.map((t,l)=>{let s=r.map(l=>getProperty(t,l)),n=s.map(t=>t.label).filter(t=>""!==t),i=n.join(n.length>1?" - ":"");return{value:s.find(t=>""!==t.value).value,label:i}});return t},filterData=t=>{var l;return null===(l=myOptions())||void 0===l?void 0:l.filter(l=>l.label.toLowerCase().includes(t.toLowerCase()))},loadOptions=(t,l)=>{setTimeout(()=>{l(filterData(t))},1e3)};return(0,s.jsxs)("div",{className:g,children:[m&&(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:m}),d&&(0,s.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,s.jsx)(i.Qr,{name:u,control:o,rules:{required:d},render:t=>{var l;let{field:{onChange:r,value:i,ref:o}}=t;return(0,s.jsx)(n.Z,{cacheOptions:!0,defaultOptions:p,isClearable:!0,isSearchable:!0,loadOptions:loadOptions,placeholder:h,menuPlacement:"auto",menuPosition:f,styles:b,ref:o,value:(null===(l=myOptions())||void 0===l?void 0:l.find(t=>t.value===i))||null,onChange:t=>r(t?t.value:t)})}}),(null==c?void 0:c.type)==="required"&&(0,s.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[m," tidak boleh kosong"]})]})}},675:function(t,l,r){"use strict";r.d(l,{Z:function(){return select_SelectTahun}});var s=r(7437),n=r(2265),i=r(523),o=r(3428),d=r(1948);r(6335),r(4887),r(6428);var u=(0,n.forwardRef)(function(t,l){var r=(0,i.u)(t);return n.createElement(d.S,(0,o.Z)({ref:l},r))}),c=r(2067),h=r.n(c),g=r(1865),select_SelectTahun=t=>{let{label:l,start:r=2012,end:n=h()().format("YYYY"),control:i,required:o,name:d,errors:c,addClass:m,menuPosition:p,placeholder:f="Pilih Tahun"}=t,pilihTahun=()=>{let t=[];for(let l=n;l>=r;l--)t.push({value:l,label:l});return t};return(0,s.jsxs)("div",{className:m,children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:l}),o&&(0,s.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,s.jsx)(g.Qr,{name:d,control:i,rules:{required:o},render:t=>{let{field:{onChange:l,value:r,name:n,ref:i}}=t;return(0,s.jsx)(u,{isClearable:!0,isSearchable:!0,options:pilihTahun(),placeholder:f,menuPosition:p,ref:i,value:r?pilihTahun().find(t=>t.value===r):r,onChange:t=>l(t?t.value:t)})}}),(null==c?void 0:c.type)==="required"&&(0,s.jsx)("p",{className:"text-red-500 font-inter italic text-sm",children:"Tahun tidak boleh kosong"})]})}},6678:function(t){(()=>{"use strict";var l={d:(t,r)=>{for(var s in r)l.o(r,s)&&!l.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:r[s]})},o:(t,l)=>Object.prototype.hasOwnProperty.call(t,l),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},r={};function a(t,l){for(var r=0;r<l.length;r++){var s=l[r];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,s.key,s)}}l.r(r),l.d(r,{default:()=>n});var s=function(){function e(){!function(t,l){if(!(t instanceof l))throw TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"changeHeightWidth",value:function(t,l,r,s,n,i){return r>s&&(t=Math.round(t*s/r),r=s),t>l&&(r=Math.round(r*l/t),t=l),n&&r<n&&(t=Math.round(t*n/r),r=n),i&&t<i&&(r=Math.round(r*i/t),t=i),{height:t,width:r}}},{key:"resizeAndRotateImage",value:function(t,l,r,s,n){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpeg",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=document.createElement("canvas"),c=t.width,h=t.height,g=this.changeHeightWidth(h,r,c,l,s,n);d&&(90===d||270===d)?(u.width=g.height,u.height=g.width):(u.width=g.width,u.height=g.height),c=g.width,h=g.height;var m=u.getContext("2d");return m.fillStyle="rgba(0, 0, 0, 0)",m.fillRect(0,0,c,h),m.imageSmoothingEnabled&&m.imageSmoothingQuality&&(m.imageSmoothingQuality="high"),d&&(m.rotate(d*Math.PI/180),90===d?m.translate(0,-u.width):180===d?m.translate(-u.width,-u.height):270===d?m.translate(-u.height,0):0!==d&&360!==d||m.translate(0,0)),m.drawImage(t,0,0,c,h),u.toDataURL("image/".concat(i),o/100)}},{key:"b64toByteArrays",value:function(t,l){l=l||"image/jpeg";for(var r=atob(t.toString().replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"")),s=[],n=0;n<r.length;n+=512){for(var i=r.slice(n,n+512),o=Array(i.length),d=0;d<i.length;d++)o[d]=i.charCodeAt(d);var u=new Uint8Array(o);s.push(u)}return s}},{key:"b64toBlob",value:function(t,l){var r=this.b64toByteArrays(t,l);return new Blob(r,{type:l,lastModified:new Date})}},{key:"b64toFile",value:function(t,l,r){var s=this.b64toByteArrays(t,r);return new File(s,l,{type:r,lastModified:new Date})}},{key:"createResizedImage",value:function(t,l,r,s,n,i,o){var d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"base64",u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=new FileReader;if(!t)throw Error("File Not Found!");if(t.type&&!t.type.includes("image"))throw Error("File Is NOT Image!");h.readAsDataURL(t),h.onload=function(){var g=new Image;g.src=h.result,g.onload=function(){var h=e.resizeAndRotateImage(g,l,r,u,c,s,n,i),m="image/".concat(s);switch(d){case"blob":o(e.b64toBlob(h,m));break;case"base64":default:o(h);break;case"file":var p=t.name.toString().replace(/(png|jpeg|jpg|webp)$/i,"").concat(s.toString());o(e.b64toFile(h,p,m))}}},h.onerror=function(t){throw Error(t)}}}]),e}();let n={imageFileResizer:function(t,l,r,n,i,o,d,u,c,h){return s.createResizedImage(t,l,r,n,i,o,d,u,c,h)}};t.exports=r})()}},function(t){t.O(0,[8447,6990,5580,4758,5166,4,1356,341,2209,589,2971,2472,1744],function(){return t(t.s=9806)}),_N_E=t.O()}]);