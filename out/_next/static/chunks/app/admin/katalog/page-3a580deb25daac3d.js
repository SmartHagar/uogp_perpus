(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[393],{9806:function(t,r,l){Promise.resolve().then(l.bind(l,4220))},4220:function(t,r,l){"use strict";l.r(r),l.d(r,{default:function(){return page}});var n=l(7437),s=l(2265),i=l(3423),o=l(7310),d=l(4660),u=l(4810),c=l(8875),h=l(5967);let g=(0,d.Ue)((0,u.mW)((t,r)=>({setFormData:t=>{let r=new FormData;return r.append("judul",t.judul),r.append("penulis",t.penulis),r.append("penerbit",t.penerbit),r.append("jenis",t.jenis),r.append("tahun",t.tahun),r.append("stok",t.stok),r.append("cover",t.cover),r},dtKatalog:[],showKatalog:[],setKatalog:async r=>{let{page:l=1,limit:n=10,search:s,jenis:i}=r;try{let r=await h.Z.getState().setToken(),o=await (0,c.Sj)({method:"get",url:"/katalog",headers:{Authorization:"Bearer ".concat(r)},params:{limit:n,page:l,search:s,jenis:i}});return t(t=>({...t,dtKatalog:o.data.data})),{status:"berhasil",data:o.data}}catch(t){var o;return{status:"error",error:null===(o=t.response)||void 0===o?void 0:o.data}}},setShowKatalog:async r=>{try{let l=await h.Z.getState().setToken(),n=await (0,c.Sj)({method:"get",url:"/katalog/".concat(r),headers:{Authorization:"Bearer ".concat(l)}});return console.log({response:n}),t(t=>({...t,showKatalog:n.data.data})),{status:"berhasil",data:n.data}}catch(t){var l;return{status:"error",error:null===(l=t.response)||void 0===l?void 0:l.data}}},addData:async l=>{let n=(null==l?void 0:l.cover)?r().setFormData(l):l;try{let r=await h.Z.getState().setToken(),l=await (0,c.Sj)({method:"post",url:"/katalog",headers:{Authorization:"Bearer ".concat(r),"Content-Type":"multipart/form-data"},data:n});return t(t=>({dtKatalog:{last_page:t.dtKatalog.last_page,current_page:t.dtKatalog.current_page,data:[l.data.data,...t.dtKatalog.data]}})),{status:"berhasil tambah",data:l.data}}catch(t){return{status:"error",data:t.response.data}}},removeData:async r=>{try{let l=await h.Z.getState().setToken(),n=await (0,c.Sj)({method:"delete",url:"/katalog/".concat(r),headers:{Authorization:"Bearer ".concat(l)}});return t(t=>({dtKatalog:{last_page:t.dtKatalog.last_page,current_page:t.dtKatalog.current_page,data:t.dtKatalog.data.filter(t=>t.id!==r)}})),{status:"berhasil hapus",data:n.data}}catch(t){return{status:"error",data:t.response.data}}},updateData:async(l,n)=>{delete n.id;let s=(null==n?void 0:n.cover)?r().setFormData(n):n,i=await h.Z.getState().setToken();try{let r=await (0,c.Sj)({url:"/katalog/".concat(l),method:"post",headers:(null==n?void 0:n.cover)?{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(i)}:{Authorization:"Bearer ".concat(i)},data:s,params:{_method:"PUT"}});return t(t=>({dtKatalog:{last_page:t.dtKatalog.last_page,current_page:t.dtKatalog.current_page,data:t.dtKatalog.data.map(t=>t.id===l?{...t,...r.data.data}:t)}})),{status:"berhasil update",data:r.data}}catch(t){return{status:"error",data:t.response.data}}}})));var p=l(5991),m=l(4033),katalog_ShowData=t=>{let{setDelete:r,setEdit:l,search:d}=t,{setKatalog:u,dtKatalog:c}=g(),[h,f]=(0,s.useState)(1),[v,b]=(0,s.useState)(10),[j,x]=(0,s.useState)(!0),y=(0,m.useSearchParams)(),w=y&&y.get("jenis")||"",fetchDataKatalog=async()=>{await u({page:h,limit:v,search:d,jenis:w}),x(!1)};return(0,s.useEffect)(()=>(fetchDataKatalog(),()=>{}),[h,v]),(0,s.useEffect)(()=>{f(1),fetchDataKatalog()},[w]),(0,s.useEffect)(()=>{f(1),fetchDataKatalog()},[d]),(0,n.jsx)("div",{className:"flex-1 flex-col max-w-full h-full overflow-auto",children:j?(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,n.jsx)(p.Z,{})}):(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"",children:(0,n.jsx)(o.Z,{headTable:["No","Judul","Penulis","Penerbit","Tahun","Stok","Cover","Aksi"],tableBodies:["judul","penulis","penerbit","tahun","stok","cover"],dataTable:c.data,page:h,limit:v,setEdit:l,setDelete:r,ubah:!0,hapus:!0})}),(null==c?void 0:c.last_page)>1&&(0,n.jsx)("div",{className:"mt-4",children:(0,n.jsx)(i.Z,{currentPage:null==c?void 0:c.current_page,totalPages:null==c?void 0:c.last_page,setPage:f})})]})})},f=l(5782),v=l(8963),b=l(311),j=l(1865),x=l(592),y=l(523),w=l(3428),S=l(7461);l(6335),l(4887),l(6428);var k=(0,s.forwardRef)(function(t,r){var l=(0,y.u)(t);return s.createElement(S.S,(0,w.Z)({ref:r},l))}),F=l(2067),_=l.n(F),select_SelectTahun=t=>{let{label:r,start:l=2012,end:s=_()().format("YYYY"),control:i,required:o,name:d,errors:u,addClass:c,menuPosition:h="fixed",placeholder:g="Pilih Tahun"}=t,pilihTahun=()=>{let t=[];for(let r=s;r>=l;r--)t.push({value:r,label:r});return t};return(0,n.jsxs)("div",{className:c,children:[(0,n.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:r}),o&&(0,n.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,n.jsx)(j.Qr,{name:d,control:i,rules:{required:o},render:t=>{let{field:{onChange:r,value:l,name:s,ref:i}}=t;return(0,n.jsx)(k,{isClearable:!0,isSearchable:!0,options:pilihTahun(),placeholder:g,menuPosition:h,ref:i,value:l?pilihTahun().find(t=>t.value===l):l,onChange:t=>r(t?t.value:t)})}}),(null==u?void 0:u.type)==="required"&&(0,n.jsx)("p",{className:"text-red-500 font-inter italic text-sm",children:"Tahun tidak boleh kosong"})]})};l(1240);var form_BodyForm=t=>{let{register:r,errors:l,control:s,dtEdit:i,watch:o,setValue:d,showModal:u,myFile:c,setMyFile:h}=t;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(f.Z,{label:"Judul",name:"judul",register:r,minLength:2,required:!0,errors:l.judul,addClass:"col-span-4"}),(0,n.jsx)(f.Z,{label:"Penulis",name:"penulis",register:r,minLength:2,required:!0,errors:l.penulis,addClass:"col-span-4"}),(0,n.jsx)(f.Z,{label:"Penerbit",name:"penerbit",register:r,minLength:2,required:!0,errors:l.penerbit,addClass:"col-span-4"}),(0,n.jsx)(select_SelectTahun,{label:"Tahun",name:"tahun",start:new Date().getFullYear()-10,end:new Date().getFullYear(),control:s,addClass:"col-span-4 lg:col-span-2",placeholder:"Pilih",required:!0,errors:l.tahun}),(0,n.jsx)(f.Z,{label:"stok",name:"stok",register:r,minLength:1,required:!0,errors:l.stok,type:"number",addClass:"col-span-4 lg:col-span-2"}),(0,n.jsx)(x.Z,{label:"Cover",name:"cover",register:r,accept:"image/*",required:!0,errors:l.cover,addClass:"col-span-4",setValue:d,fileEdit:null==i?void 0:i.cover,myFile:c,setMyFile:h})]})},D=l(8528),form_Form=t=>{let{showModal:r,setShowModal:l,dtEdit:i}=t,[o,d]=(0,s.useState)(),u=(0,m.useSearchParams)(),c=u&&u.get("jenis")||"",{addData:h,updateData:p}=g(),{register:x,handleSubmit:y,setValue:w,control:S,formState:{errors:k},watch:F}=(0,j.cI)(),resetForm=()=>{w("id",""),w("judul",""),w("penulis",""),w("penerbit",""),w("tahun",""),w("stok",1),w("cover",""),d(null)};(0,s.useEffect)(()=>{i?(w("id",i.id),w("judul",i.judul),w("penulis",i.penulis),w("penerbit",i.penerbit),w("tahun",parseInt(i.tahun)),w("stok",i.stok),w("cover",i.cover)):resetForm()},[r,i]);let onSubmit=async t=>{if(console.log({row:t}),t.jenis=c,i){let{data:r}=await p(i.id,t);(0,b.Z)({event:r}),l(!1)}else{let{data:r}=await h(t);console.log({data:r}),(0,b.Z)({event:r}),(null==r?void 0:r.type)!=="success"||resetForm()}};return(0,n.jsx)(v.Z,{title:"Form Katalog",showModal:r,setShowModal:l,children:(0,n.jsxs)("form",{onSubmit:y(onSubmit),children:[(0,n.jsx)(f.Z,{name:"id",register:x,type:"hidden"}),(0,n.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-4",children:(0,n.jsx)(form_BodyForm,{register:x,errors:k,dtEdit:i,control:S,watch:F,setValue:w,showModal:r,myFile:o,setMyFile:d})}),(0,n.jsx)("div",{children:(0,n.jsx)(D.Z,{onClick:y(onSubmit),addClass:"btn-primary",children:"Simpan"})})]})})},C=l(3015),K=l(5925),N=l(8001),page=()=>{let{removeData:t}=g(),[r,l]=(0,s.useState)(!1),[i,o]=(0,s.useState)(!1),[d,u]=(0,s.useState)(),[c,h]=(0,s.useState)(),[p,f]=(0,s.useState)(""),v=(0,m.useSearchParams)(),j=v&&v.get("jenis"),setDelete=async r=>{let{id:l,isDelete:n}=r;if(u(l),n){let{data:r}=await t(d);(0,b.Z)({event:r}),o(!1)}else o(!0)};return(0,n.jsxs)("div",{className:"flex flex-col h-full",children:[(0,n.jsxs)("div",{children:[(0,n.jsx)(K.x7,{}),(0,n.jsx)(form_Form,{dtEdit:c,showModal:r,setShowModal:l}),(0,n.jsx)(C.Z,{showDel:i,setShowDel:o,setDelete:setDelete}),(0,n.jsxs)("div",{className:"mb-4 flex justify-between",children:[(0,n.jsxs)("p",{children:["Silahkan mengolah data katalog ",(0,n.jsx)("span",{children:j})]}),(0,n.jsx)("div",{children:(0,n.jsx)(D.Z,{onClick:()=>{l(!0),h(null)},addClass:"btn-primary",children:"Tambah"})})]}),(0,n.jsx)(N.Z,{placeholder:"Cari Katalog",onChange:t=>f(t)})]}),(0,n.jsx)(katalog_ShowData,{setDelete:setDelete,setEdit:t=>{l(!0),h(t)},search:p})]})}},592:function(t,r,l){"use strict";var n=l(7437),s=l(8875),i=l(6691),o=l.n(i),d=l(2265),u=l(6678),c=l.n(u);r.Z=t=>{let{label:r,register:l,required:i,name:u,errors:h,addClass:g,accept:p,setValue:m,fileEdit:f,myFile:v,setMyFile:b}=t,[j,x]=(0,d.useState)(),resizeFile=t=>new Promise(()=>{if(t){var r;let l=(null==t?void 0:null===(r=t.type)||void 0===r?void 0:r.split("/"))||[],n=l[0];if("image"!==n)return onSelectFile(t);console.log({splitType:l}),c().imageFileResizer(t,1500,1500,l[1],80,0,t=>{onSelectFile(t)},"file")}else onSelectFile(null)}),onSelectFile=t=>{var r;if(t){let r=new FileReader;r.readAsDataURL(t),r.onloadend=()=>{b(r.result)}}let l=(null==t?void 0:null===(r=t.type)||void 0===r?void 0:r.split("/"))||[];x(l[0]),m(u,t)};return(0,n.jsxs)("div",{className:g,children:[(0,n.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:r}),i&&(0,n.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,n.jsx)("input",{className:"w-full text-base px-4 py-2 border  border-gray-300 rounded-lg focus:outline-none focus:border-secondary",id:"fileInput",type:"file",accept:p,onChange:t=>{var r;let l=(null===(r=t.target)||void 0===r?void 0:r.files[0])||null;resizeFile(l)}}),(0,n.jsx)("input",{type:"hidden",id:r,...l(u,{required:i})}),(0,n.jsxs)("div",{className:"flex gap-4 mt-2",children:[v&&"image"===j&&(0,n.jsx)(o(),{className:"rounded-lg",src:v,width:100,height:100,alt:""}),f&&"file"!==u&&(0,n.jsx)("div",{children:(0,n.jsx)(o(),{src:"".concat(s._n,"/").concat(f),width:100,height:100,alt:""})})]}),(null==h?void 0:h.type)==="required"&&(0,n.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[r," tidak boleh kosong"]})]})}},6678:function(t){(()=>{"use strict";var r={d:(t,l)=>{for(var n in l)r.o(l,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:l[n]})},o:(t,r)=>Object.prototype.hasOwnProperty.call(t,r),r:t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})}},l={};function a(t,r){for(var l=0;l<r.length;l++){var n=r[l];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}r.r(l),r.d(l,{default:()=>s});var n=function(){function e(){!function(t,r){if(!(t instanceof r))throw TypeError("Cannot call a class as a function")}(this,e)}return a(e,[{key:"changeHeightWidth",value:function(t,r,l,n,s,i){return l>n&&(t=Math.round(t*n/l),l=n),t>r&&(l=Math.round(l*r/t),t=r),s&&l<s&&(t=Math.round(t*s/l),l=s),i&&t<i&&(l=Math.round(l*i/t),t=i),{height:t,width:l}}},{key:"resizeAndRotateImage",value:function(t,r,l,n,s){var i=arguments.length>5&&void 0!==arguments[5]?arguments[5]:"jpeg",o=arguments.length>6&&void 0!==arguments[6]?arguments[6]:100,d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:0,u=document.createElement("canvas"),c=t.width,h=t.height,g=this.changeHeightWidth(h,l,c,r,n,s);d&&(90===d||270===d)?(u.width=g.height,u.height=g.width):(u.width=g.width,u.height=g.height),c=g.width,h=g.height;var p=u.getContext("2d");return p.fillStyle="rgba(0, 0, 0, 0)",p.fillRect(0,0,c,h),p.imageSmoothingEnabled&&p.imageSmoothingQuality&&(p.imageSmoothingQuality="high"),d&&(p.rotate(d*Math.PI/180),90===d?p.translate(0,-u.width):180===d?p.translate(-u.width,-u.height):270===d?p.translate(-u.height,0):0!==d&&360!==d||p.translate(0,0)),p.drawImage(t,0,0,c,h),u.toDataURL("image/".concat(i),o/100)}},{key:"b64toByteArrays",value:function(t,r){r=r||"image/jpeg";for(var l=atob(t.toString().replace(/^data:image\/(png|jpeg|jpg|webp);base64,/,"")),n=[],s=0;s<l.length;s+=512){for(var i=l.slice(s,s+512),o=Array(i.length),d=0;d<i.length;d++)o[d]=i.charCodeAt(d);var u=new Uint8Array(o);n.push(u)}return n}},{key:"b64toBlob",value:function(t,r){var l=this.b64toByteArrays(t,r);return new Blob(l,{type:r,lastModified:new Date})}},{key:"b64toFile",value:function(t,r,l){var n=this.b64toByteArrays(t,l);return new File(n,r,{type:l,lastModified:new Date})}},{key:"createResizedImage",value:function(t,r,l,n,s,i,o){var d=arguments.length>7&&void 0!==arguments[7]?arguments[7]:"base64",u=arguments.length>8&&void 0!==arguments[8]?arguments[8]:null,c=arguments.length>9&&void 0!==arguments[9]?arguments[9]:null,h=new FileReader;if(!t)throw Error("File Not Found!");if(t.type&&!t.type.includes("image"))throw Error("File Is NOT Image!");h.readAsDataURL(t),h.onload=function(){var g=new Image;g.src=h.result,g.onload=function(){var h=e.resizeAndRotateImage(g,r,l,u,c,n,s,i),p="image/".concat(n);switch(d){case"blob":o(e.b64toBlob(h,p));break;case"base64":default:o(h);break;case"file":var m=t.name.toString().replace(/(png|jpeg|jpg|webp)$/i,"").concat(n.toString());o(e.b64toFile(h,m,p))}}},h.onerror=function(t){throw Error(t)}}}]),e}();let s={imageFileResizer:function(t,r,l,s,i,o,d,u,c,h){return n.createResizedImage(t,r,l,s,i,o,d,u,c,h)}};t.exports=l})()}},function(t){t.O(0,[447,990,463,103,589,971,472,744],function(){return t(t.s=9806)}),_N_E=t.O()}]);