(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3393],{8689:function(e,a,t){Promise.resolve().then(t.bind(t,6512))},6512:function(e,a,t){"use strict";t.r(a),t.d(a,{default:function(){return page}});var l=t(7437),s=t(2265),r=t(3423),n=t(3842),i=t(4660),o=t(4810),d=t(8875),u=t(5967);let c=(0,i.Ue)((0,o.mW)((e,a)=>({setFormData:e=>{let a=new FormData;return a.append("judul",e.judul),a.append("class_sub_id",e.class_sub_id),a.append("penulis",e.penulis),a.append("penerbit",e.penerbit),a.append("jenis",e.jenis),a.append("tahun",e.tahun),a.append("stok",e.stok),a.append("cover",e.cover),a},dtKatalog:[],showKatalog:[],setKatalog:async a=>{let{page:t=1,limit:l=10,search:s,jenis:r}=a;try{let a=await u.Z.getState().setToken(),n=await (0,d.Sj)({method:"get",url:"/katalog",headers:{Authorization:"Bearer ".concat(a)},params:{limit:l,page:t,search:s,jenis:r}});return e(e=>({...e,dtKatalog:n.data.data})),{status:"berhasil",data:n.data}}catch(e){var n;return{status:"error",error:null===(n=e.response)||void 0===n?void 0:n.data}}},setShowKatalog:async a=>{try{let t=await u.Z.getState().setToken(),l=await (0,d.Sj)({method:"get",url:"/katalog/".concat(a),headers:{Authorization:"Bearer ".concat(t)}});return console.log({response:l}),e(e=>({...e,showKatalog:l.data.data})),{status:"berhasil",data:l.data}}catch(e){var t;return{status:"error",error:null===(t=e.response)||void 0===t?void 0:t.data}}},addData:async t=>{let l=(null==t?void 0:t.cover)?a().setFormData(t):t;try{let a=await u.Z.getState().setToken(),t=await (0,d.Sj)({method:"post",url:"/katalog",headers:{Authorization:"Bearer ".concat(a),"Content-Type":"multipart/form-data"},data:l});return e(e=>({dtKatalog:{last_page:e.dtKatalog.last_page,current_page:e.dtKatalog.current_page,data:[t.data.data,...e.dtKatalog.data]}})),{status:"berhasil tambah",data:t.data}}catch(e){return{status:"error",data:e.response.data}}},removeData:async a=>{try{let t=await u.Z.getState().setToken(),l=await (0,d.Sj)({method:"delete",url:"/katalog/".concat(a),headers:{Authorization:"Bearer ".concat(t)}});return e(e=>({dtKatalog:{last_page:e.dtKatalog.last_page,current_page:e.dtKatalog.current_page,data:e.dtKatalog.data.filter(e=>e.id!==a)}})),{status:"berhasil hapus",data:l.data}}catch(e){return{status:"error",data:e.response.data}}},updateData:async(t,l)=>{delete l.id;let s=(null==l?void 0:l.cover)?a().setFormData(l):l,r=await u.Z.getState().setToken();try{let a=await (0,d.Sj)({url:"/katalog/".concat(t),method:"post",headers:(null==l?void 0:l.cover)?{"Content-Type":"multipart/form-data",Authorization:"Bearer ".concat(r)}:{Authorization:"Bearer ".concat(r)},data:s,params:{_method:"PUT"}});return e(e=>({dtKatalog:{last_page:e.dtKatalog.last_page,current_page:e.dtKatalog.current_page,data:e.dtKatalog.data.map(e=>e.id===t?{...e,...a.data.data}:e)}})),{status:"berhasil update",data:a.data}}catch(e){return{status:"error",data:e.response.data}}}})));var h=t(5991),p=t(4033),katalog_slide=e=>{let a=null==e?void 0:e.map(e=>({src:"".concat(d._n,"/").concat(null==e?void 0:e.cover),title:e.judul,description:e.penulis,width:3840,height:5760}));return console.log({dtImages:a}),a},m=t(6996),katalog_ShowData=e=>{let{setDelete:a,setEdit:t,search:i}=e,{setKatalog:o,dtKatalog:d}=c(),[u,g]=(0,s.useState)(1),[v,f]=(0,s.useState)(10),[x,b]=(0,s.useState)(!0),[j,S]=(0,s.useState)(-1),[y,_]=(0,s.useState)(),w=(0,p.useSearchParams)(),k=w&&w.get("jenis")||"",fetchDataKatalog=async()=>{await o({page:u,limit:v,search:i,jenis:k}),b(!1)};return(0,s.useEffect)(()=>(fetchDataKatalog(),()=>{}),[u,v]),(0,s.useEffect)(()=>{g(1),fetchDataKatalog()},[k]),(0,s.useEffect)(()=>{g(1),fetchDataKatalog()},[i]),(0,s.useEffect)(()=>{_(katalog_slide(d.data))},[d.data]),(0,l.jsxs)("div",{className:"flex-1 flex-col max-w-full h-full overflow-auto",children:[(0,l.jsx)(m.Z,{index:j,setIndex:S,slides:y}),x?(0,l.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,l.jsx)(h.Z,{})}):(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"",children:(0,l.jsx)(n.Z,{headTable:["No","Class Sub","Judul","Penulis","Penerbit","Tahun","Stok","Cover","Aksi"],tableBodies:["class_sub.nm_sub","judul","penulis","penerbit","tahun","stok","cover"],dataTable:d.data,page:u,limit:v,setEdit:t,setDelete:a,ubah:!0,hapus:!0,setIndexBox:S})}),(null==d?void 0:d.last_page)>1&&(0,l.jsx)("div",{className:"mt-4",children:(0,l.jsx)(r.Z,{currentPage:null==d?void 0:d.current_page,totalPages:null==d?void 0:d.last_page,setPage:g})})]})]})},g=t(5782),v=t(8963),f=t(311),x=t(1865),b=t(592),j=t(945),S=t(675);let y=(0,i.Ue)((0,o.mW)((e,a)=>({dtClassSub:[],setClassSub:async a=>{let{page:t=1,limit:l=10,search:s}=a;try{let a=await (0,d.hi)({method:"get",url:"/classSub",params:{limit:l,page:t,search:s}});return e(e=>({...e,dtClassSub:a.data})),{status:"berhasil",data:a.data}}catch(e){return{status:"error",error:e.response.data}}},setClassSubAll:async a=>{let{search:t}=a;try{let a=await (0,d.hi)({method:"get",url:"/classSub/all",params:{search:t}});return e(e=>({...e,dtClassSub:a.data})),{status:"berhasil",data:a.data}}catch(e){return{status:"error",error:e.response.data}}}})));t(1240);var form_BodyForm=e=>{let{register:a,errors:t,control:r,dtEdit:n,watch:i,setValue:o,showModal:d,myFile:u,setMyFile:c}=e,{setClassSubAll:h,dtClassSub:p}=y(),fetchDataClassSub=async e=>{let{search:a}=e;await h({search:a})};return(0,s.useEffect)(()=>{fetchDataClassSub({})},[d]),(0,l.jsxs)(l.Fragment,{children:[(null==p?void 0:p.data)&&(0,l.jsx)(j.Z,{label:"Class Sub",placeholder:"Pilih Class Sub",name:"class_sub_id",dataDb:null==p?void 0:p.data,body:["id","class_umum.nm_umum","nm_sub"],control:r,required:!0,errors:t.class_sub_id,addClass:"col-span-4 lg:col-span-2"}),(0,l.jsx)(g.Z,{label:"Judul",name:"judul",register:a,minLength:2,required:!0,errors:t.judul,addClass:"col-span-4"}),(0,l.jsx)(g.Z,{label:"Penulis",name:"penulis",register:a,minLength:2,required:!0,errors:t.penulis,addClass:"col-span-4"}),(0,l.jsx)(g.Z,{label:"Penerbit",name:"penerbit",register:a,minLength:2,required:!0,errors:t.penerbit,addClass:"col-span-4"}),(0,l.jsx)(S.Z,{label:"Tahun",name:"tahun",start:new Date().getFullYear()-50,end:new Date().getFullYear(),control:r,addClass:"col-span-4 lg:col-span-2",placeholder:"Pilih",required:!0,errors:t.tahun}),(0,l.jsx)(g.Z,{label:"stok",name:"stok",register:a,minLength:1,required:!0,errors:t.stok,type:"number",addClass:"col-span-4 lg:col-span-2"}),(0,l.jsx)(b.Z,{label:"Cover",name:"cover",register:a,accept:"image/*",required:!0,errors:t.cover,addClass:"col-span-4",setValue:o,fileEdit:null==n?void 0:n.cover,myFile:u,setMyFile:c})]})},_=t(8528),form_Form=e=>{let{showModal:a,setShowModal:t,dtEdit:r}=e,[n,i]=(0,s.useState)(),o=(0,p.useSearchParams)(),d=o&&o.get("jenis")||"",{addData:u,updateData:h}=c(),{register:m,handleSubmit:b,setValue:j,control:S,formState:{errors:y},watch:w}=(0,x.cI)(),resetForm=()=>{j("id",""),j("class_sub_id",""),j("judul",""),j("penulis",""),j("penerbit",""),j("tahun",""),j("stok",1),j("cover",""),i(null)};(0,s.useEffect)(()=>{r?(j("id",r.id),j("class_sub_id",r.class_sub_id),j("judul",r.judul),j("penulis",r.penulis),j("penerbit",r.penerbit),j("tahun",parseInt(r.tahun)),j("stok",r.stok),j("cover",r.cover)):resetForm()},[a,r]);let onSubmit=async e=>{if(console.log({row:e}),e.jenis=d,r){let{data:a}=await h(r.id,e);(0,f.Z)({event:a}),t(!1)}else{let{data:a}=await u(e);console.log({data:a}),(0,f.Z)({event:a}),(null==a?void 0:a.type)!=="success"||resetForm()}};return(0,l.jsx)(v.Z,{title:"Form Katalog",showModal:a,setShowModal:t,children:(0,l.jsxs)("form",{onSubmit:b(onSubmit),children:[(0,l.jsx)(g.Z,{name:"id",register:m,type:"hidden"}),(0,l.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-4",children:(0,l.jsx)(form_BodyForm,{register:m,errors:y,dtEdit:r,control:S,watch:w,setValue:j,showModal:a,myFile:n,setMyFile:i})}),(0,l.jsx)("div",{children:(0,l.jsx)(_.Z,{type:"submit",onClick:b(onSubmit),addClass:"btn-primary",children:"Simpan"})})]})})},w=t(3015),k=t(5925),C=t(8001),page=()=>{let{removeData:e}=c(),[a,t]=(0,s.useState)(!1),[r,n]=(0,s.useState)(!1),[i,o]=(0,s.useState)(),[d,u]=(0,s.useState)(),[h,m]=(0,s.useState)(""),g=(0,p.useSearchParams)(),v=g&&g.get("jenis"),setDelete=async a=>{let{id:t,isDelete:l}=a;if(o(t),l){let{data:a}=await e(i);(0,f.Z)({event:a}),n(!1)}else n(!0)};return(0,l.jsxs)("div",{className:"flex flex-col h-full",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)(k.x7,{}),(0,l.jsx)(form_Form,{dtEdit:d,showModal:a,setShowModal:t}),(0,l.jsx)(w.Z,{showDel:r,setShowDel:n,setDelete:setDelete}),(0,l.jsxs)("div",{className:"mb-4 flex justify-between",children:[(0,l.jsxs)("p",{children:["Silahkan mengolah data katalog ",(0,l.jsx)("span",{children:v})]}),(0,l.jsx)("div",{children:(0,l.jsx)(_.Z,{onClick:()=>{t(!0),u(null)},addClass:"btn-primary",children:"Tambah"})})]}),(0,l.jsx)(C.Z,{placeholder:"Cari Katalog",onChange:e=>m(e)})]}),(0,l.jsx)(katalog_ShowData,{setDelete:setDelete,setEdit:e=>{t(!0),u(e)},search:h})]})}},592:function(e,a,t){"use strict";var l=t(7437),s=t(8875),r=t(6691),n=t.n(r),i=t(2265),o=t(6678),d=t.n(o);a.Z=e=>{let{label:a,register:t,required:r,name:o,errors:u,addClass:c,accept:h,setValue:p,fileEdit:m,myFile:g,setMyFile:v}=e,[f,x]=(0,i.useState)(),resizeFile=e=>new Promise(()=>{if(e){var a;let t=(null==e?void 0:null===(a=e.type)||void 0===a?void 0:a.split("/"))||[],l=t[0];if("image"!==l)return onSelectFile(e);console.log({splitType:t}),d().imageFileResizer(e,1500,1500,t[1],80,0,e=>{onSelectFile(e)},"file")}else onSelectFile(null)}),onSelectFile=e=>{var a;if(e){let a=new FileReader;a.readAsDataURL(e),a.onloadend=()=>{v(a.result)}}let t=(null==e?void 0:null===(a=e.type)||void 0===a?void 0:a.split("/"))||[];x(t[0]),p(o,e)};return(0,l.jsxs)("div",{className:c,children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:a}),r&&(0,l.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,l.jsx)("input",{className:"w-full text-base px-4 py-2 border  border-gray-300 rounded-lg focus:outline-none focus:border-secondary",id:"fileInput",type:"file",accept:h,onChange:e=>{var a;let t=(null===(a=e.target)||void 0===a?void 0:a.files[0])||null;resizeFile(t)}}),(0,l.jsx)("input",{type:"hidden",id:a,...t(o,{required:r})}),(0,l.jsxs)("div",{className:"flex gap-4 mt-2",children:[g&&"image"===f&&(0,l.jsx)(n(),{className:"rounded-lg",src:g,width:100,height:100,alt:""}),m&&"file"!==o&&(0,l.jsx)("div",{children:(0,l.jsx)(n(),{src:"".concat(s._n,"/").concat(m),width:100,height:100,alt:""})})]}),(null==u?void 0:u.type)==="required"&&(0,l.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[a," tidak boleh kosong"]})]})}},6996:function(e,a,t){"use strict";var l=t(7437);t(2265);var s=t(9200);t(9303);var r=t(8643),n=t(1213);t(7309),t(4858),a.Z=e=>{let{index:a,setIndex:t,slides:i}=e;return(0,l.jsx)(s.ZP,{index:a,slides:i,open:a>=0,close:()=>t(-1),plugins:[r.Z,n.Z]})}},945:function(e,a,t){"use strict";var l=t(7437);t(2265);var s=t(8749),r=t(1865);a.Z=e=>{let{dataDb:a,body:t,control:n,required:i,name:o,errors:d,placeholder:u,addClass:c,label:h,defaultOptions:p=!0,menuPosition:m}=e,g={multiValue:(e,a)=>a.data.isFixed?{...e,backgroundColor:"gray"}:e,multiValueLabel:(e,a)=>a.data.isFixed?{...e,fontWeight:"bold",color:"white",paddingRight:6}:e,multiValueRemove:(e,a)=>a.data.isFixed?{...e,display:"none"}:e},getProperty=(e,a)=>{let t=e[a];if("id"===a)return{value:t,label:""};if(!a.includes("."))return{value:"",label:t};{let[t,...l]=a.split("."),s=e[t];return getProperty(s,l.join("."))}},myOptions=()=>{let e=a&&a.map((e,a)=>{let l=t.map(a=>getProperty(e,a)),s=l.map(e=>e.label).filter(e=>""!==e),r=s.join(s.length>1?" - ":"");return{value:l.find(e=>""!==e.value).value,label:r}});return e},filterData=e=>{var a;return null===(a=myOptions())||void 0===a?void 0:a.filter(a=>a.label.toLowerCase().includes(e.toLowerCase()))},loadOptions=(e,a)=>{setTimeout(()=>{a(filterData(e))},1e3)};return(0,l.jsxs)("div",{className:c,children:[h&&(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:h}),i&&(0,l.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,l.jsx)(r.Qr,{name:o,control:n,rules:{required:i},render:e=>{var a;let{field:{onChange:t,value:r,ref:n}}=e;return(0,l.jsx)(s.Z,{cacheOptions:!0,defaultOptions:p,isClearable:!0,isSearchable:!0,loadOptions:loadOptions,placeholder:u,menuPlacement:"auto",menuPosition:m,styles:g,ref:n,value:(null===(a=myOptions())||void 0===a?void 0:a.find(e=>e.value===r))||null,onChange:e=>t(e?e.value:e)})}}),(null==d?void 0:d.type)==="required"&&(0,l.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[h," tidak boleh kosong"]})]})}},675:function(e,a,t){"use strict";t.d(a,{Z:function(){return select_SelectTahun}});var l=t(7437),s=t(2265),r=t(523),n=t(3428),i=t(1948);t(6335),t(4887),t(6428);var o=(0,s.forwardRef)(function(e,a){var t=(0,r.u)(e);return s.createElement(i.S,(0,n.Z)({ref:a},t))}),d=t(2067),u=t.n(d),c=t(1865),select_SelectTahun=e=>{let{label:a,start:t=2012,end:s=u()().format("YYYY"),control:r,required:n,name:i,errors:d,addClass:h,menuPosition:p,placeholder:m="Pilih Tahun"}=e,pilihTahun=()=>{let e=[];for(let a=s;a>=t;a--)e.push({value:a,label:a});return e};return(0,l.jsxs)("div",{className:h,children:[(0,l.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:a}),n&&(0,l.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,l.jsx)(c.Qr,{name:i,control:r,rules:{required:n},render:e=>{let{field:{onChange:a,value:t,name:s,ref:r}}=e;return(0,l.jsx)(o,{isClearable:!0,isSearchable:!0,options:pilihTahun(),placeholder:m,menuPosition:p,ref:r,value:t?pilihTahun().find(e=>e.value===t):t,onChange:e=>a(e?e.value:e)})}}),(null==d?void 0:d.type)==="required"&&(0,l.jsx)("p",{className:"text-red-500 font-inter italic text-sm",children:"Tahun tidak boleh kosong"})]})}}},function(e){e.O(0,[8447,6990,5580,4758,5166,4,8672,341,2209,2364,8623,2971,2472,1744],function(){return e(e.s=8689)}),_N_E=e.O()}]);