(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8339],{3649:function(a,e,t){Promise.resolve().then(t.bind(t,7904))},7904:function(a,e,t){"use strict";t.r(e),t.d(e,{default:function(){return page}});var s=t(7437),r=t(2265),l=t(5991),n=t(3423),i=t(3842),d=t(4660),o=t(4810),u=t(8875),c=t(5967);let g=(0,d.Ue)((0,o.mW)((a,e)=>({dtTransaksi:[],showTransaksi:[],setTransaksi:async e=>{let{page:t=1,limit:s=10,search:r,tahun:l,semester:n}=e;try{let e=await c.Z.getState().setToken(),i=await (0,u.Sj)({method:"get",url:"/transaksi",headers:{Authorization:"Bearer ".concat(e)},params:{limit:s,page:t,search:r,tahun:l,semester:n}});return a(a=>({...a,dtTransaksi:i.data.data})),{status:"berhasil",data:i.data}}catch(a){var i;return{status:"error",error:null===(i=a.response)||void 0===i?void 0:i.data}}},setShowTransaksi:async e=>{try{let t=await c.Z.getState().setToken(),s=await (0,u.Sj)({method:"get",url:"/transaksi/".concat(e),headers:{Authorization:"Bearer ".concat(t)}});return a(a=>({...a,showTransaksi:s.data.data})),{status:"berhasil",data:s.data}}catch(a){var t;return{status:"error",error:null===(t=a.response)||void 0===t?void 0:t.data}}},addData:async e=>{try{let t=await c.Z.getState().setToken(),s=await (0,u.Sj)({method:"post",url:"/transaksi",headers:{Authorization:"Bearer ".concat(t)},data:e});return a(a=>({dtTransaksi:{last_page:a.dtTransaksi.last_page,current_page:a.dtTransaksi.current_page,data:[s.data.data,...a.dtTransaksi.data]}})),{status:"berhasil tambah",data:s.data}}catch(a){return{status:"error",data:a.response.data}}},removeData:async e=>{try{let t=await c.Z.getState().setToken(),s=await (0,u.Sj)({method:"delete",url:"/transaksi/".concat(e),headers:{Authorization:"Bearer ".concat(t)}});return a(a=>({dtTransaksi:{last_page:a.dtTransaksi.last_page,current_page:a.dtTransaksi.current_page,data:a.dtTransaksi.data.filter(a=>a.id!==e)}})),{status:"berhasil hapus",data:s.data}}catch(a){return{status:"error",data:a.response.data}}},updateData:async(e,t)=>{try{let s=await c.Z.getState().setToken(),r=await (0,u.Sj)({method:"PUT",url:"/transaksi/".concat(e),headers:{Authorization:"Bearer ".concat(s)},data:t});return a(a=>({dtTransaksi:{last_page:a.dtTransaksi.last_page,current_page:a.dtTransaksi.current_page,data:a.dtTransaksi.data.map(a=>a.id===e?{...a,...r.data.data}:a)}})),{status:"berhasil update",data:r.data}}catch(a){return{status:"error",data:a.response.data}}}})));var m=t(4033),transaksi_ShowData=a=>{let{setDelete:e,setEdit:t,search:d}=a,{setTransaksi:o,dtTransaksi:u}=g(),[c,h]=(0,r.useState)(1),[p,x]=(0,r.useState)(10),[j,k]=(0,r.useState)(!0),f=(0,m.useSearchParams)(),b=f&&f.get("status")||"",fetchDataTransaksi=async()=>{await o({page:c,limit:p,search:d}),k(!1)};(0,r.useEffect)(()=>(fetchDataTransaksi(),()=>{}),[c,p]),(0,r.useEffect)(()=>{h(1),fetchDataTransaksi()},[d,b]);let v=["No","Anggota","Judul","Keperluan","Tgl. Pinjam","Aksi"],y=["anggota.nama","katalog.judul","keperluan","tgl_pinjam"];if("pengembalian"===b){let a=v.length-1;v.splice(a,0,"Tgl. Kembali"),y.splice(a,0,"tgl_kembali");let e=v.length-1;v.splice(e,0,"Denda"),y.splice(e,0,"denda")}return(0,s.jsx)("div",{className:"flex-1 flex-col max-w-full h-full overflow-auto",children:j?(0,s.jsx)("div",{className:"w-full h-full flex items-center justify-center",children:(0,s.jsx)(l.Z,{})}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)("div",{className:"",children:(0,s.jsx)(i.Z,{headTable:v,tableBodies:y,dataTable:u.data,page:c,limit:p,setEdit:t,setDelete:e,ubah:!0,hapus:!0})}),(null==u?void 0:u.last_page)>1&&(0,s.jsx)("div",{className:"mt-4",children:(0,s.jsx)(n.Z,{currentPage:null==u?void 0:u.current_page,totalPages:null==u?void 0:u.last_page,setPage:h})})]})})},h=t(5782),p=t(8963),x=t(311),j=t(1865),k=t(9948),f=t(2218),b=t.n(f),v=t(2067),y=t.n(v),input_InputDateMinMax=a=>{let{control:e,required:t,name:r,errors:l,addClass:n,label:i,startDate:d,setStartDate:o,minDate:u,maxDate:c}=a;return(0,s.jsxs)("div",{className:n,children:[(0,s.jsxs)("label",{className:"text-sm font-medium text-gray-700 tracking-wide block",children:[i,t&&(0,s.jsx)("span",{className:"ml-1 text-red-600",children:"*"})]}),(0,s.jsx)(j.Qr,{name:r,control:e,rules:{required:t},render:a=>{let{field:e}=a;return(0,s.jsx)(b(),{selected:d,onChange:a=>{if(a){o(a);let t=y()(a).format("YYYY-MM-DD");e.onChange(t)}else o(null),e.onChange("")},dateFormat:"dd/MM/yyyy",value:d||"",peekNextMonth:!0,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",className:"w-full border rounded-lg py-2 px-4 bg-white",placeholderText:"dd/mm/yyyy",minDate:u,maxDate:c})}}),(null==l?void 0:l.type)==="required"&&(0,s.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[i," tidak boleh kosong"]})]})},w=t(5022),_=t(945);let D=(0,d.Ue)((0,o.mW)((a,e)=>({dtAnggota:[],setAnggota:async e=>{let{page:t=1,limit:s=10,search:r}=e;try{let e=await (0,u.hi)({method:"get",url:"/anggota",params:{limit:s,page:t,search:r}});return a(a=>({...a,dtAnggota:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setAnggotaAll:async e=>{let{search:t}=e;try{let e=await (0,u.hi)({method:"get",url:"/anggota/all",params:{search:t}});return a(a=>({...a,dtAnggota:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}}})));var S=t(6446);t(1240);var form_BodyForm=a=>{var e;let{register:t,errors:l,control:n,dtEdit:i,watch:d,setValue:o,showModal:u,tgl_pinjam:c,setTgl_pinjam:g,setTgl_kembali:p,tgl_kembali:x}=a,{setAnggotaAll:j,dtAnggota:f}=D(),{setKatalogReady:b,dtKatalog:v}=(0,S.Z)(),[T,N]=(0,r.useState)(),M=(0,m.useSearchParams)(),Z=M&&M.get("status")||"",fetchDataAnggota=async a=>{let{search:e}=a;await j({search:e})};(0,r.useEffect)(()=>{fetchDataAnggota({})},[u]);let C=d("jenis")||"",fetchDataKatalog=async a=>{let{search:e,jenis:t}=a;await b({search:e,jenis:t}),N(!0)};(0,r.useEffect)(()=>{N(!1),C&&fetchDataKatalog({jenis:C})},[C]);let K=d("tgl_pinjam"),P=d("tgl_kembali"),countDays=()=>{if(K&&P){let a=y()(P).diff(y()(K),"days");(null==i?void 0:i.keperluan)==="Skripsi"?a>6?o("denda",1e3*(a-6)):o("denda",0):a>2?o("denda",1e3*(a-2)):o("denda",0)}};return(0,r.useEffect)(()=>{countDays()},[K,P]),(0,s.jsxs)(s.Fragment,{children:[(null==f?void 0:f.data)&&(0,s.jsx)(_.Z,{label:"Anggota",placeholder:"Pilih Anggota",name:"anggota_id",dataDb:null==f?void 0:f.data,body:["id","NPM","nama"],control:n,required:!0,errors:l.anggota_id,addClass:"col-span-4"}),i?(0,s.jsx)("div",{className:"col-span-4",children:null==i?void 0:null===(e=i.katalog)||void 0===e?void 0:e.judul}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(w.u,{label:"Jenis Katalog",defaultOption:"Pilih Jenis",register:t,errors:l,name:"jenis",options:[{value:"buku",label:"Buku"},{value:"jurnal",label:"Jurnal"},{value:"tugas akhir",label:"Tugas Akhir"}],addClass:"col-span-4 lg:col-span-1",required:!0}),T&&(null==v?void 0:v.data)&&(0,s.jsx)(_.Z,{label:"Katalog",placeholder:"Pilih Katalog",name:"katalog_id",dataDb:null==v?void 0:v.data,body:["id","judul","penulis","tahun"],control:n,required:!0,errors:l.katalog_id,addClass:"col-span-4 lg:col-span-3 "})]}),"peminjaman"===Z&&(0,s.jsx)(w.u,{label:"Keperluan",defaultOption:"Pilih Keperluan",register:t,errors:l,name:"keperluan",options:[{value:"Lainnya",label:"Lainnya"},{value:"Skripsi",label:"Skripsi"}],addClass:"col-span-4 lg:col-span-2",required:!0}),(0,s.jsx)(k.Z,{label:"Tgl. Peminjaman",name:"tgl_pinjam",control:n,startDate:c,setStartDate:g,required:!0,errors:l.tgl_pinjam,addClass:"col-span-4 lg:col-span-2"}),"pengembalian"===Z&&i.tgl_pinjam&&(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(input_InputDateMinMax,{label:"Tgl. Kembali",name:"tgl_kembali",control:n,startDate:x,setStartDate:p,required:!0,errors:l.tgl_kembali,addClass:"col-span-4 lg:col-span-2",minDate:new Date(null==i?void 0:i.tgl_pinjam)}),(0,s.jsx)(h.Z,{label:"Denda (Rp.)",name:"denda",register:t,maxLength:12,required:!0,errors:l.denda,addClass:"col-span-4",readOnly:!0})]})]})},T=t(8528),form_Form=a=>{let{showModal:e,setShowModal:t,dtEdit:l}=a,{addData:n,updateData:i}=g(),[d,o]=(0,r.useState)(new Date),[u,c]=(0,r.useState)(""),k=(0,m.useSearchParams)(),f=k&&k.get("status")||"",{register:b,handleSubmit:v,setValue:w,control:_,formState:{errors:D},watch:S}=(0,j.cI)(),resetForm=()=>{w("id",""),w("anggota_id",""),w("katalog_id",""),w("tgl_pinjam",y()(new Date).format("YYYY-MM-DD")),w("tgl_kembali",""),o(new Date),c(""),w("jenis",""),w("denda",0),w("keperluan","")};(0,r.useEffect)(()=>{l?(w("id",l.id),w("anggota_id",l.anggota_id),w("katalog_id",l.katalog_id),w("jenis",l.katalog.jenis),w("tgl_pinjam",l.tgl_pinjam),w("tgl_kembali",l.tgl_kembali),o(new Date(l.tgl_pinjam)),c(l.tgl_kembali?new Date(l.tgl_kembali):""),w("keperluan",l.keperluan)):resetForm()},[e,l]);let onSubmit=async a=>{if(a.status=f,delete a.jenis,console.log({row:a}),l){let{data:e}=await i(l.id,a);(0,x.Z)({event:e}),t(!1)}else{let{data:e}=await n(a);console.log({data:e}),(0,x.Z)({event:e}),(null==e?void 0:e.type)!=="success"||resetForm()}};return(0,s.jsx)(p.Z,{title:"Form Transaksi",showModal:e,setShowModal:t,children:(0,s.jsxs)("form",{onSubmit:v(onSubmit),children:[(0,s.jsx)(h.Z,{name:"id",register:b,type:"hidden"}),(0,s.jsx)("div",{className:"grid grid-cols-4 gap-2 mb-4",children:(0,s.jsx)(form_BodyForm,{register:b,errors:D,dtEdit:l,control:_,watch:S,setValue:w,showModal:e,tgl_pinjam:d,setTgl_pinjam:o,tgl_kembali:u,setTgl_kembali:c})}),(0,s.jsx)("div",{children:(0,s.jsx)(T.Z,{onClick:v(onSubmit),children:"Simpan"})})]})})},N=t(3015),M=t(5925),Z=t(8001),page=()=>{let{removeData:a}=g(),[e,t]=(0,r.useState)(!1),[l,n]=(0,r.useState)(!1),[i,d]=(0,r.useState)(),[o,u]=(0,r.useState)(),[c,h]=(0,r.useState)(""),p=(0,m.useSearchParams)(),j=p&&p.get("status"),setDelete=async e=>{let{id:t,isDelete:s}=e;if(d(t),s){let{data:e}=await a(i);(0,x.Z)({event:e}),n(!1)}else n(!0)};return(0,s.jsxs)("div",{className:"flex flex-col h-full",children:[(0,s.jsxs)("div",{children:[(0,s.jsx)(M.x7,{}),(0,s.jsx)(form_Form,{dtEdit:o,showModal:e,setShowModal:t}),(0,s.jsx)(N.Z,{showDel:l,setShowDel:n,setDelete:setDelete}),(0,s.jsxs)("div",{className:"mb-4 flex justify-between",children:[(0,s.jsxs)("p",{children:["Silahkan mengolah data transaksi ",j]}),"pengembalian"!==j&&(0,s.jsx)("div",{children:(0,s.jsx)(T.Z,{onClick:()=>{t(!0),u(null)},children:"Tambah"})})]}),(0,s.jsx)(Z.Z,{placeholder:"Cari Transaksi",onChange:a=>h(a)})]}),(0,s.jsx)(transaksi_ShowData,{setDelete:setDelete,setEdit:a=>{t(!0),u(a)},search:c})]})}},9948:function(a,e,t){"use strict";var s=t(7437);t(2265);var r=t(1865),l=t(2218),n=t.n(l),i=t(2067),d=t.n(i);e.Z=a=>{let{control:e,required:t,name:l,errors:i,addClass:o,label:u,startDate:c,setStartDate:g}=a;return(0,s.jsxs)("div",{className:o,children:[(0,s.jsxs)("label",{className:"text-sm font-medium text-gray-700 tracking-wide block",children:[u,t&&(0,s.jsx)("span",{className:"ml-1 text-red-600",children:"*"})]}),(0,s.jsx)(r.Qr,{name:l,control:e,rules:{required:t},render:a=>{let{field:e}=a;return(0,s.jsx)(n(),{selected:c,onChange:a=>{if(a){g(a);let t=d()(a).format("YYYY-MM-DD");e.onChange(t)}else g(null),e.onChange("")},dateFormat:"dd/MM/yyyy",value:c||"",peekNextMonth:!0,showMonthDropdown:!0,showYearDropdown:!0,dropdownMode:"select",className:"w-full border rounded-lg py-2 px-4 bg-white"})}}),(null==i?void 0:i.type)==="required"&&(0,s.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[u," tidak boleh kosong"]})]})}},5022:function(a,e,t){"use strict";t.d(e,{u:function(){return SelectDefault}});var s=t(7437);t(2265);let SelectDefault=a=>{var e;let{label:t,register:r,required:l,name:n,placeholder:i,defaultOption:d,options:o=[],errors:u,addClass:c}=a;return(0,s.jsxs)("div",{className:c,children:[(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:t}),l&&(0,s.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,s.jsx)("div",{className:"relative",children:(0,s.jsxs)("select",{className:"w-full rounded-lg py-2 px-2 bg-white border border-gray-300 focus:outline-none focus:border-secondary",id:t,placeholder:i,...r(n,{required:l}),children:[(0,s.jsx)("option",{value:"",children:d}),o.map((a,e)=>(0,s.jsx)("option",{value:a.value,children:a.label},e))]})}),(null===(e=u[n])||void 0===e?void 0:e.type)==="required"&&(0,s.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[t," tidak boleh kosong"]})]})}},945:function(a,e,t){"use strict";var s=t(7437);t(2265);var r=t(8749),l=t(1865);e.Z=a=>{let{dataDb:e,body:t,control:n,required:i,name:d,errors:o,placeholder:u,addClass:c,label:g,defaultOptions:m=!0,menuPosition:h}=a,p={multiValue:(a,e)=>e.data.isFixed?{...a,backgroundColor:"gray"}:a,multiValueLabel:(a,e)=>e.data.isFixed?{...a,fontWeight:"bold",color:"white",paddingRight:6}:a,multiValueRemove:(a,e)=>e.data.isFixed?{...a,display:"none"}:a},getProperty=(a,e)=>{let t=a[e];if("id"===e)return{value:t,label:""};if(!e.includes("."))return{value:"",label:t};{let[t,...s]=e.split("."),r=a[t];return getProperty(r,s.join("."))}},myOptions=()=>{let a=e&&e.map((a,e)=>{let s=t.map(e=>getProperty(a,e)),r=s.map(a=>a.label).filter(a=>""!==a),l=r.join(r.length>1?" - ":"");return{value:s.find(a=>""!==a.value).value,label:l}});return a},filterData=a=>{var e;return null===(e=myOptions())||void 0===e?void 0:e.filter(e=>e.label.toLowerCase().includes(a.toLowerCase()))},loadOptions=(a,e)=>{setTimeout(()=>{e(filterData(a))},1e3)};return(0,s.jsxs)("div",{className:c,children:[g&&(0,s.jsx)("label",{className:"text-sm font-medium text-gray-700 tracking-wide",children:g}),i&&(0,s.jsx)("span",{className:"ml-1 text-red-600",children:"*"}),(0,s.jsx)(l.Qr,{name:d,control:n,rules:{required:i},render:a=>{var e;let{field:{onChange:t,value:l,ref:n}}=a;return(0,s.jsx)(r.Z,{cacheOptions:!0,defaultOptions:m,isClearable:!0,isSearchable:!0,loadOptions:loadOptions,placeholder:u,menuPlacement:"auto",menuPosition:h,styles:p,ref:n,value:(null===(e=myOptions())||void 0===e?void 0:e.find(a=>a.value===l))||null,onChange:a=>t(a?a.value:a)})}}),(null==o?void 0:o.type)==="required"&&(0,s.jsxs)("p",{className:"text-red-500 font-inter italic text-sm",children:[g," tidak boleh kosong"]})]})}},6446:function(a,e,t){"use strict";var s=t(4660),r=t(4810),l=t(8875);let n=(0,s.Ue)((0,r.mW)((a,e)=>({dtKatalog:[],setKatalog:async e=>{let{page:t=1,limit:s=10,orderBy:r,sort:n,search:i}=e;try{let e=await (0,l.hi)({method:"get",url:"/katalog",params:{limit:s,page:t,orderBy:r,sort:n,search:i}});return a(a=>({...a,dtKatalog:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setKatalogAll:async e=>{let{search:t}=e;try{let e=await (0,l.hi)({method:"get",url:"/katalog/all",params:{search:t}});return a(a=>({...a,dtKatalog:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setKatalogReady:async e=>{let{search:t,jenis:s}=e;try{let e=await (0,l.hi)({method:"get",url:"/katalog/ready",params:{search:t,jenis:s}});return a(a=>({...a,dtKatalog:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}},setKatalogDetail:async e=>{try{let t=await (0,l.hi)({method:"get",url:"/katalog/detail/".concat(e)});return a(a=>{var e;return{...a,dtKatalog:null===(e=t.data)||void 0===e?void 0:e.data}}),{status:"berhasil",data:t.data}}catch(a){return{status:"error",error:a.response.data}}},setLapKatalog:async e=>{let{jenis:t,tahun:s}=e;try{let e=await (0,l.hi)({method:"get",url:"/katalog/laporan",params:{jenis:t,tahun:s}});return a(a=>({...a,dtKatalog:e.data})),{status:"berhasil",data:e.data}}catch(a){return{status:"error",error:a.response.data}}}})));e.Z=n}},function(a){a.O(0,[8447,6990,5580,4758,5166,4,8672,341,2209,2218,8623,2971,2472,1744],function(){return a(a.s=3649)}),_N_E=a.O()}]);